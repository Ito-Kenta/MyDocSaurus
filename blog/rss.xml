<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xsl" href="rss.xsl"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>My Site Blog</title>
        <link>https://Ito-Kenta.github.io/MyDocSaurus/blog</link>
        <description>My Site Blog</description>
        <lastBuildDate>Sun, 25 May 2025 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[First post]]></title>
            <link>https://Ito-Kenta.github.io/MyDocSaurus/blog/2025/05/25/最初の投稿</link>
            <guid>https://Ito-Kenta.github.io/MyDocSaurus/blog/2025/05/25/最初の投稿</guid>
            <pubDate>Sun, 25 May 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[最初の投稿です。]]></description>
            <content:encoded><![CDATA[<p>最初の投稿です。</p>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Next.jsプロジェクトのCloudflare Pagesへの公開]]></title>
            <link>https://Ito-Kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.jsプロジェクトのCloudflare Pagesへの公開</link>
            <guid>https://Ito-Kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.jsプロジェクトのCloudflare Pagesへの公開</guid>
            <pubDate>Sun, 25 May 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[前置き]]></description>
            <content:encoded><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前置き">前置き<a href="https://ito-kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.js%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AECloudflare%20Pages%E3%81%B8%E3%81%AE%E5%85%AC%E9%96%8B#%E5%89%8D%E7%BD%AE%E3%81%8D" class="hash-link" aria-label="Direct link to 前置き" title="Direct link to 前置き">​</a></h2>
<p>初めて自分のWebアプリケーションを公開します。まずは無料で公開できる方法ということでCloudflare Pagesを使うことにしました。出来上がったページはこちらです！
<a href="https://mychaptertube.pages.dev/" target="_blank" rel="noopener noreferrer">https://mychaptertube.pages.dev/</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="やりたいこと">やりたいこと<a href="https://ito-kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.js%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AECloudflare%20Pages%E3%81%B8%E3%81%AE%E5%85%AC%E9%96%8B#%E3%82%84%E3%82%8A%E3%81%9F%E3%81%84%E3%81%93%E3%81%A8" class="hash-link" aria-label="Direct link to やりたいこと" title="Direct link to やりたいこと">​</a></h3>
<p>Next.jsで作ったプロジェクトをcloudflare pagesに公開する。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="制約事項">制約事項<a href="https://ito-kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.js%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AECloudflare%20Pages%E3%81%B8%E3%81%AE%E5%85%AC%E9%96%8B#%E5%88%B6%E7%B4%84%E4%BA%8B%E9%A0%85" class="hash-link" aria-label="Direct link to 制約事項" title="Direct link to 制約事項">​</a></h3>
<p>無料プランで公開する。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="前提条件">前提条件<a href="https://ito-kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.js%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AECloudflare%20Pages%E3%81%B8%E3%81%AE%E5%85%AC%E9%96%8B#%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6" class="hash-link" aria-label="Direct link to 前提条件" title="Direct link to 前提条件">​</a></h3>
<ul>
<li>Next.jsのプロジェクトは作成済み。<!-- -->
<ul>
<li>プロジェクトはGitHubにpush済み。</li>
<li>プロジェクトにはフロントエンドのみが含まれ、バックエンドは含まれていない。</li>
</ul>
</li>
<li>Cloudflareのアカウントは持っていない。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="手順">手順<a href="https://ito-kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.js%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AECloudflare%20Pages%E3%81%B8%E3%81%AE%E5%85%AC%E9%96%8B#%E6%89%8B%E9%A0%86" class="hash-link" aria-label="Direct link to 手順" title="Direct link to 手順">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloudflareアカウントの作成">Cloudflareアカウントの作成<a href="https://ito-kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.js%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AECloudflare%20Pages%E3%81%B8%E3%81%AE%E5%85%AC%E9%96%8B#cloudflare%E3%82%A2%E3%82%AB%E3%82%A6%E3%83%B3%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90" class="hash-link" aria-label="Direct link to Cloudflareアカウントの作成" title="Direct link to Cloudflareアカウントの作成">​</a></h3>
<p><a href="https://www.cloudflare.com/" target="_blank" rel="noopener noreferrer">Cloudflareの公式サイト</a>にアクセスし、無用プランでアカウントを作成した。今回はGoogleアカウントと連携させる形にした。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="プロジェクトを静的サイトとしてエクスポート">プロジェクトを静的サイトとしてエクスポート<a href="https://ito-kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.js%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AECloudflare%20Pages%E3%81%B8%E3%81%AE%E5%85%AC%E9%96%8B#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E9%9D%99%E7%9A%84%E3%82%B5%E3%82%A4%E3%83%88%E3%81%A8%E3%81%97%E3%81%A6%E3%82%A8%E3%82%AF%E3%82%B9%E3%83%9D%E3%83%BC%E3%83%88" class="hash-link" aria-label="Direct link to プロジェクトを静的サイトとしてエクスポート" title="Direct link to プロジェクトを静的サイトとしてエクスポート">​</a></h3>
<p>Cloudflare Pagesの無料プランではNext.jsプロジェクトを予め静的ファイルにエクスポートしておく必要がある。</p>
<ol>
<li>Next.jsプロジェクトフォルダ内のnext.config.tsを開き、以下の設定を追加する。
この設定は<code>npm run export</code>や<code>next export</code>を実行し、ビルド済みのアプリケーションを静的ファイルとして出力する工程で適用される。ビルドは<code>npm run buid</code>や<code>next buid</code>で行う。</li>
</ol>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">/next.config.ts</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> NextConfig </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"next"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> nextConfig</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> NextConfig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  output</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'export'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ビルド時に静的エクスポートする</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  trailingSlash</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic">// （必要に応じて）末尾にスラッシュを付与</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> nextConfig</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>ローカルで動作確認
下記コマンドを実行しローカルで動作確認を行う。プロジェクト直下にout/ディレクトリが作成されていることを確認する。</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># -&gt; OKだったので次に進む</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>GitHubにプッシュ
この状態でGitHubにプッシュする。</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloudflare-pagesにプロジェクトを接続">Cloudflare Pagesにプロジェクトを接続<a href="https://ito-kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.js%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AECloudflare%20Pages%E3%81%B8%E3%81%AE%E5%85%AC%E9%96%8B#cloudflare-pages%E3%81%AB%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%82%92%E6%8E%A5%E7%B6%9A" class="hash-link" aria-label="Direct link to Cloudflare Pagesにプロジェクトを接続" title="Direct link to Cloudflare Pagesにプロジェクトを接続">​</a></h3>
<ol>
<li>Cloudflareのダッシュボードの左側パネルから、コンピューティング(Workers) -&gt; Workers &amp; Pages をクリックする。</li>
<li>表示されるページ上でPagesタブをクリックし、「既存のGitリポジトリをインポートする」で始めるボタンをクリックする。
<img decoding="async" loading="lazy" alt="alt text" src="https://ito-kenta.github.io/MyDocSaurus/assets/images/cloudflare-create-pages-image-9039861f12c25f41364c74d0ef29b4a0.png" width="1278" height="785" class="img_ev3q"></li>
<li>アカウントからサイトをデプロイする画面でGitHubに接続ボタンを押す。GitHubと連携画面に遷移しInstall &amp; Authorize Cloudflare Workers and Pagesという設定ページに移る。Only select repositoriesを選んでInstall &amp; Authorizeする。最後に「セットアップの開始」ボタンを押す。</li>
<li>プロジェクト名を設定し、プロダクションブランチをmainとした。ビルドの設定は下記の通り:<!-- -->
<table><thead><tr><th>項目</th><th>値</th></tr></thead><tbody><tr><td>Framework preset</td><td>Next.js</td></tr><tr><td>Build command</td><td><code>npx next build</code></td></tr><tr><td>Build output folder</td><td><code>out</code></td></tr><tr><td>Root directory</td><td>frontend</td></tr></tbody></table>
</li>
</ol>
<p>Next.jsプロジェクトをリポジトリ直下ではなくfrontendフォルダで作成していたためルートディレクトリを設定した。環境変数は使用していないので設定していない。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="プロジェクトのデプロイ">プロジェクトのデプロイ<a href="https://ito-kenta.github.io/MyDocSaurus/blog/2025/05/25/Next.js%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AECloudflare%20Pages%E3%81%B8%E3%81%AE%E5%85%AC%E9%96%8B#%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E3%83%87%E3%83%97%E3%83%AD%E3%82%A4" class="hash-link" aria-label="Direct link to プロジェクトのデプロイ" title="Direct link to プロジェクトのデプロイ">​</a></h3>
<p>Cloudflare Pagesのダッシュボードでデプロイボタンをクリックした。</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Next.jsのバージョンとデプロイスクリプトの対応</div><div class="admonitionContent_BuS1"><p>最初に上記手順でデプロイしようとしたところ、Cloudflare上でのアプリケーションのビルドに失敗した。
エラーメッセージはこれ。</p><div class="language-log codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-log codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">16:49:18.749	Executing user command: npx next build</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">16:49:19.594	You are using Node.js 18.17.1. For Next.js, Node.js version "^18.18.0 || ^19.8.0 || &gt;= 20.0.0" is required.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">16:49:19.608	Failed: Error while executing user command. Exited with error code: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">16:49:19.617	Failed: build command exited with code: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">16:49:20.599	Failed: error occurred while running build command</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Cloudflare pagesのビルド環境がデフォルトでNode.js v18.17.1を使っているが、私が使用したNext.js v15では<code>^18.18.0 || ^19.8.0 || &gt;=20.0.0</code>を要求している。したがって、ビルドに使用するNode.jsのバージョンを明示的に指定することで解決する。具体的には、プロジェクトフォルダ（今回はfrontend）直下に<code>.nvmrc</code>ファイルを配置し<code>18.18.0</code>と設定した。</p></div></div>]]></content:encoded>
            <category>Next.js</category>
            <category>Cloudflare</category>
        </item>
    </channel>
</rss>